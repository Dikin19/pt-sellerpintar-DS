(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[631],{2612:(e,t,s)=>{Promise.resolve().then(s.bind(s,5022))},4616:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5022:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>O});var a=s(5155),l=s(2115),r=s(7827);function n(e){let{title:t,description:s,children:l}=e;return(0,a.jsx)("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:t}),s&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:s})]}),l&&(0,a.jsx)("div",{className:"flex items-center gap-3",children:l})]})})}var o=s(5127),c=s(285),i=s(5623),d=s(3717),g=s(2525),h=s(2457);function u(e){let{categories:t,onEdit:s,onDelete:l}=e,r=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return 0===t.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border",children:[(0,a.jsx)("p",{className:"text-muted-foreground text-lg",children:"No categories found."}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm mt-2",children:"Create your first category to get started."})]}):(0,a.jsx)("div",{className:"bg-white rounded-lg border",children:(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"Name"}),(0,a.jsx)(o.nd,{children:"Created"}),(0,a.jsx)(o.nd,{children:"Updated"}),(0,a.jsx)(o.nd,{className:"w-12"})]})}),(0,a.jsx)(o.BF,{children:t.filter(e=>{let t=e.id||e._id||e.categoryId;return t||console.warn("Filtering out category without valid ID:",e),t}).map(e=>{console.log("Rendering category in table:",e),console.log("Category ID in table:",e.id);let t=e.id||e._id||e.categoryId||Math.random();return(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nA,{children:(0,a.jsx)("p",{className:"font-medium text-sm",children:e.name})}),(0,a.jsx)(o.nA,{className:"text-sm text-muted-foreground",children:r(e.createdAt)}),(0,a.jsx)(o.nA,{className:"text-sm text-muted-foreground",children:r(e.updatedAt)}),(0,a.jsx)(o.nA,{children:(0,a.jsxs)(h.rI,{children:[(0,a.jsx)(h.ty,{asChild:!0,children:(0,a.jsx)(c.$,{variant:"ghost",size:"sm",children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(h.SQ,{align:"end",children:[(0,a.jsxs)(h._2,{onClick:()=>null==s?void 0:s(e),children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,a.jsxs)(h._2,{onClick:()=>null==l?void 0:l(e),className:"text-destructive",children:[(0,a.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},t)})})]})})}var x=s(2177),m=s(8778),y=s(4165),j=s(2523),p=s(5057),f=s(343),v=s(5731),N=s(1154),b=s(7481);function C(e){let{open:t,onOpenChange:s,category:r,onSuccess:n}=e,[o,i]=(0,l.useState)(!1),{toast:d}=(0,b.dj)(),g=!!r,{register:h,handleSubmit:u,formState:{errors:C},reset:w,setValue:A}=(0,x.mN)({resolver:(0,m.u)(f.WM),defaultValues:{name:""}});(0,l.useEffect)(()=>{r?A("name",r.name):w()},[r,A,w]);let S=async e=>{try{if(i(!0),g&&r){console.log("=== CATEGORY EDIT DEBUG ==="),console.log("Full category object:",JSON.stringify(r,null,2)),console.log("Category keys:",Object.keys(r)),console.log("Category.id:",r.id),console.log("typeof category.id:",typeof r.id),console.log("category.id === undefined:",void 0===r.id),console.log("category.id === null:",null===r.id),console.log("category.id === '':",""===r.id);let t={id:r.id,_id:r._id,categoryId:r.categoryId,ID:r.ID};console.log("Possible ID fields:",t);let s=r.id||r._id||r.categoryId||r.ID;if(console.log("Selected categoryId:",s),console.log("typeof categoryId:",typeof s),!s||""===s.toString().trim())throw console.error("ERROR: No valid category ID found!"),Error("Category ID is missing or empty. Available fields: ".concat(Object.keys(r).join(", ")));console.log("Proceeding with update using ID:",s),await (0,v.st)(s.toString(),e),d({title:"Success",description:"Category updated successfully"})}else console.log("Creating new category"),await (0,v.zZ)(e),d({title:"Success",description:"Category created successfully"});n(),s(!1),w()}catch(e){console.error("Category form error:",e),d({title:"Error",description:e.message||"Failed to save category",variant:"destructive"})}finally{i(!1)}};return(0,a.jsx)(y.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(y.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(y.c7,{children:[(0,a.jsx)(y.L3,{children:g?"Edit Category":"Create New Category"}),(0,a.jsx)(y.rr,{children:g?"Update the category details below.":"Fill in the form below to create a new category."})]}),(0,a.jsxs)("form",{onSubmit:u(S),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"name",children:"Category Name"}),(0,a.jsx)(j.p,{id:"name",...h("name"),placeholder:"Enter category name"}),C.name&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:C.name.message})]}),(0,a.jsxs)(y.Es,{children:[(0,a.jsx)(c.$,{type:"button",variant:"outline",onClick:()=>{s(!1),w()},children:"Cancel"}),(0,a.jsxs)(c.$,{type:"submit",disabled:o,children:[o&&(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}),g?"Update Category":"Create Category"]})]})]})]})})}var w=s(10);function A(e){let{open:t,onOpenChange:s,category:r,onSuccess:n}=e,[o,c]=(0,l.useState)(!1),i=async()=>{if(r){c(!0);try{await (0,v.K7)(r.id),n(),s(!1)}catch(e){console.error("Delete category error:",e)}finally{c(!1)}}};return(0,a.jsx)(w.Lt,{open:t,onOpenChange:s,children:(0,a.jsxs)(w.EO,{children:[(0,a.jsxs)(w.wd,{children:[(0,a.jsx)(w.r7,{children:"Delete Category"}),(0,a.jsxs)(w.$v,{children:['Are you sure you want to delete "',null==r?void 0:r.name,'"? This action cannot be undone. All articles in this category will need to be reassigned.']})]}),(0,a.jsxs)(w.ck,{children:[(0,a.jsx)(w.Zr,{disabled:o,children:"Cancel"}),(0,a.jsxs)(w.Rx,{onClick:i,disabled:o,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[o&&(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete"]})]})]})})}var S=s(9289),D=s(9750),E=s(9797),k=s(7023),I=s(4616);function O(){let[e,t]=(0,l.useState)([]),[s,o]=(0,l.useState)(!0),[i,d]=(0,l.useState)({page:1,totalPages:1,total:0}),[g,h]=(0,l.useState)(""),[x,m]=(0,l.useState)(!1),[y,j]=(0,l.useState)(!1),[p,f]=(0,l.useState)(null),N=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;o(!0);try{var s,a,l,r,n,c,i;let o=await (0,v.bW)({search:g,page:e,limit:10});console.log("Categories API response:",o),console.log("Categories data:",o.data),o.data&&Array.isArray(o.data)&&o.data.forEach((e,t)=>{console.log("Category ".concat(t,":"),e),console.log("Category ".concat(t," ID:"),e.id)}),t(o.data||[]),d({page:null!==(n=null===(s=o.pagination)||void 0===s?void 0:s.page)&&void 0!==n?n:e,totalPages:null!==(c=null===(a=o.pagination)||void 0===a?void 0:a.totalPages)&&void 0!==c?c:1,total:null!==(i=null===(l=o.pagination)||void 0===l?void 0:l.total)&&void 0!==i?i:(null===(r=o.data)||void 0===r?void 0:r.length)||0})}catch(e){console.error("Failed to fetch categories:",e),t([]),d({page:1,totalPages:1,total:0})}finally{o(!1)}},[g]);(0,l.useEffect)(()=>{N(1)},[N]);let b=(0,l.useCallback)(e=>{h(e)},[]),w=(0,l.useCallback)(e=>{N(e)},[N]),O=()=>{N(i.page)};return(0,a.jsx)(S.K,{allowedRoles:["Admin"],children:(0,a.jsxs)(r.U,{children:[(0,a.jsx)(n,{title:"Categories",description:"Manage article categories",children:(0,a.jsxs)(c.$,{onClick:()=>{f(null),m(!0)},children:[(0,a.jsx)(I.A,{className:"mr-2 h-4 w-4"}),"New Category"]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"mb-6 max-w-md",children:(0,a.jsx)(D.D,{value:g,onSearch:b,placeholder:"Search categories...",debounceMs:400})}),s?(0,a.jsx)(k.R,{text:"Loading categories..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{categories:e,onEdit:e=>{console.log("=== HANDLE EDIT DEBUG ==="),console.log("handleEdit called with category:",JSON.stringify(e,null,2)),console.log("Category keys:",Object.keys(e)),console.log("Category.id:",e.id),console.log("typeof category.id:",typeof e.id),console.log("Setting selectedCategory state..."),f(e),console.log("Opening form dialog..."),m(!0)},onDelete:e=>{f(e),j(!0)}}),(0,a.jsx)(E.d,{currentPage:i.page,totalPages:i.totalPages,onPageChange:w})]})]}),(0,a.jsx)(C,{open:x,onOpenChange:m,category:p,onSuccess:O}),(0,a.jsx)(A,{open:y,onOpenChange:j,category:p,onSuccess:O})]})})}},5525:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},7023:(e,t,s)=>{"use strict";s.d(t,{R:()=>n});var a=s(5155),l=s(9434);function r(e){let{className:t,size:s="md"}=e;return(0,a.jsx)("div",{className:(0,l.cn)("animate-spin rounded-full border-2 border-gray-300 border-t-blue-600",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[s],t)})}function n(e){let{className:t,text:s="Loading..."}=e;return(0,a.jsxs)("div",{className:(0,l.cn)("flex items-center justify-center gap-2 p-4",t),children:[(0,a.jsx)(r,{}),(0,a.jsx)("span",{className:"text-gray-600",children:s})]})}},7924:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9289:(e,t,s)=>{"use strict";s.d(t,{K:()=>i});var a=s(5155),l=s(2115),r=s(5695),n=s(7600),o=s(1154),c=s(5525);function i(e){let{children:t,allowedRoles:s,fallback:i}=e,{user:d,isLoading:g,isAuthenticated:h}=(0,n.As)(),{hasRole:u}=(0,n.JT)(),x=(0,r.useRouter)();return((0,l.useEffect)(()=>{g||h||x.push("/login")},[g,h,x]),g)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(o.A,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):d&&h?s.some(e=>u(e))?(0,a.jsx)(a.Fragment,{children:t}):i?(0,a.jsx)(a.Fragment,{children:i}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(c.A,{className:"h-16 w-16 mx-auto text-red-400 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["You don't have permission to access this page. Required role: ",s.join(" or "),"."]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Your current role: ",d.role]})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(c.A,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Authentication Required"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Redirecting to login..."})]})})}},9750:(e,t,s)=>{"use strict";s.d(t,{D:()=>c});var a=s(5155),l=s(2115),r=s(7924),n=s(2523),o=s(9434);function c(e){let{value:t="",placeholder:s="Search...",onSearch:c,debounceMs:i=300,className:d}=e,[g,h]=(0,l.useState)(t);return(0,l.useEffect)(()=>{let e=setTimeout(()=>{c(g)},i);return()=>clearTimeout(e)},[g,c,i]),(0,l.useEffect)(()=>{h(t)},[t]),(0,a.jsxs)("div",{className:(0,o.cn)("relative",d),children:[(0,a.jsx)(r.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),(0,a.jsx)(n.p,{value:g,onChange:e=>h(e.target.value),placeholder:s,className:"pl-10"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[464,503,371,45,561,600,639,441,684,358],()=>t(2612)),_N_E=e.O()}]);